# 아이템58. 모던 자바스크립트로 작성하기

타입스크립트는 타입 체크 기능 외에, 타입스크립트 코드를 특정 버전의 자바스크립트로 컴파일하는 기능도 가지고 있다.
즉, 타입스크립트 컴파일러를 자바스크립트 '트랜스파일러'로도 사용할 수 있다.

구 버전의 자바스크립트 코드를 타입스크립트 컴파일러에서 동작하게 만들면 이후로는 최신 버전의
자바스크립트 기능을 코드에 추가해도 문제가 없었다. 구버전의 자바스크립트 코드를 최신 버전의
자바스크립트로 바꾸는 작업은 타입스크립트로 전환하는 작업의 일부로 볼 수 있다.

따라서, 마이그레이션을 어디서부터 시작해야 할지 몰라 막막하다면, 구버전의 자바스크립트 코드를
최신 버전의 자바스크립트로 바꾸는 작업부터 시작해보길 바란다.
타입스크립트는 자바스크립트의 상위집합이기 때문에, 코드를 최신 버전으로 바꾸다 보면 타입스크립트의 일부를 저절로 익힐 수 있다.

여기서, 모던 자바스크립트의 주요 기능 몇 가지를 간략히 다루어보자.
주요 기능들은 ES2015 버전부터 도입된 것이며, 최신 자바스크립트 기능도 모두 체크되기 때문에
코드 작성 시에 도움을 받을 수 있고, 제대로 된 사용법을 배울 수 있다.

모던 자바스크립트의 새로운 기능들은 모두 배울 만한 가치가 있지만, 타입스크립트를 도입할 때
가장 중요한 기능은 ECMAScript 모듈과 ES2015 클래스이다.

### ESMAScript 모듈 사용하기

ES2015 이전에는 코드를 개별 모듈로 분할하는 표준 방법이 없었지만, 현재는 개별 모듈로 분할하는 방법이 많아졌는데,
ES2015 부터는 import, export를 사용하는 ECMAScript 모듈이 표준이 되었다.

만약, 마이그레이션 대상인 자바스크립트 코드가 단일 파일이거나, 비표준 모듈 시스템을 사용 중이라면 ES모듈로 전환하는 것이 좋다.
그리고, ES 모듈 시스템을 사용하기 위해서 프로젝트 종류에 따라 웹팩이나, ts-node 같은 도구가 필요한 경우도 있다.

ES 모듈 시스템은 타입스크립트에서도 잘 동작하며, 모듈 단위로 전환할 수 있게 해 주기 때문에 점진적 마이그레이션이 원활해진다.

### 프로토타입 대신 클래스 사용하기

과거의 자바스크립트에서는 프로토타입을 기반으로한 객체 모델을 사용했지만, ES2015에 class 키워드를 사용하는
클래스 기반 모델이 도입되었다. 마이그레이션하려는 코드에서 단순한 객체를 다룰 때 프로토타입을 사용하고 있었다면,
클래스로 바꾸는 것이 좋다.

```ts
//prototype
function Person(first, last) {
  this.first = first;
  this.last = last;
}

Person.prototype.getName = function () {
  return this.first + " " + this.last;
};

const marie = new Person("Marie", "Curie");
const personName = marie.getName();

//class
// tsConfig: {"noImplicitAny":false}
class Person {
  first: string;
  last: string;

  constructor(first: string, last: string) {
    this.first = first;
    this.last = last;
  }

  getName() {
    return this.first + " " + this.last;
  }
}

const marie = new Person("Marie", "Curie");
const personName = marie.getName();
```

프로토타입으로 구현한 Person 객체보다 클래스로 구현한 Person 객체가 문법이 간결하고 직관적이다.
클래스 문법에 익숙하지 않더라도 타입스크립트 언어 서비스를 활용하면 클래스를 간단히 작성할 수 있다.

편집기에서 프로토타입 객체에 마우스를 올려, 타입스크립트 언어 서비스인 '함수를 ES2015 클래스로 변환'을 선택하면
간단히 클래스 객체로 변환할 수 있다.

### var 대신 let/const 사용하기

자바스크립트 var 키워드의 스코프 규칙에 문제가 있다는 것은 널리 알려진 사실이다.
만약, var 키워드를 let이나 const로 변경하면, 일부 코드에서 타입스크립트가 오류를 표시할 수 있다.
오류가 발생한 부분은 잡재적으로 스코프 문제가 존재하는 코드이기 때문에 수정해야 한다.

중첩된 함수 구문에도 var의 경우와 비슷한 스코프 문제가 존재한다. foo 함수를 호출하면 bar 함수의
정의가 호이스팅되어 가장 먼저 수행되기 때문에 문제없이 호출되고 'hello'가 출력된다.
호이스팅은 실행 순서에 혼란을 가져오는 동작으로 직관적이지 않기 때문에 대신 함수 표현식을 사용하여
호이스팅을 피하는 것이 좋다.

```js
function foo() {
  bar();
  function bar() {
    console.log("hello");
  }
}
```

### for(;;;) 대신 for-of 또는 배열 메서드 사용하기

과거 자바스크립트에서는 배열을 순회할 때 C 스타일의 for 루프를 사용했지만,
모던 자바스크립트에는 for-of 루프가 존재하며, for-of 루프는 코드가 짧고 인덱스 변수를 사용하지 않기 때문에
실수를 줄일 수 있다. 인덱스 변수가 필요한 경우에는 forEach 메서드를 사용하면 된다.

```js
for (const el of array) {
  //...
}

array.forEach((el, i) => {
  //...
});
```

(작성중..)
